# GameOfLife
javaScript game of Life by John Conway

Игра Жизнь Джона Конвея реализованнная на языке Java Script

GitHubPages: https://sergio-ka.github.io/GameOfLife/

Диаграмма классов UML: https://sergio-ka.github.io/GameOfLife/UMLdiaofclass.png

Структура игры состоит из следующих классов:

1. Класс ModelSquare. Класс ячейки. В своих полях содержит инвормацию о содержимом ячейки (статусы "жива"-"мертва") на трех последних поколениях игры. Так же содержит геттеры и сеттеры для доступа к этим полям. При вызове конструктора поля равны 0 (то есть "мертвы"). Содержит единственный метод, который при его вызове меняет состояние в текущем поколении на противоположное для данной ячейки. Класс относится к Model паттерна MVC.

2. Класс ModelField. Класс поля (или "вселенной"). В своих полях содержит: псевдодвумерный массив для населения его экземплярами класса ячейки; размеры поля по вертикали и горизонтали (инициализируются при вызове конструктора цифрами 3 - минимально допустимый размер); номер текущего поколения (инициализируется числом 1); флаг остановки игры (инициализируется нулем, имеет 4 состояния для вывода причины остановки в соответствии с логикой игры). В составе класса имеются геттеры и сеттеры для доступа к размерам поля, номеру поколения и флагу остановки игры, которые осуществляют валидацию значений при записи. Так же имеются следующие методы:
+ "CreateRandomField" - создает массив необходимой размерности, заполняет его экземплярами класса ModelSquare, устанавливает рандомное значение для текущего шага у каждой ячейки (0 или 1 - "мертва" или "жива"). При этом ячейки по краям поля всегда "мертвы".
+ "ClearField" - делает все то же самое, но все ячейки поля заполняет нулями (все "мертвы"). Такой подход позволяет не только отчистить рандомно созданное поле, но и создать пустой холст и рисовать на нем нажимая на ячейки мышкой. Так же обнуляются все значения ячеек и на прошедших поколения, как следствие работа методов остановки игры при сложении устойчивых комбинаций всегда корректна.
+ "CropFieldOnX" и "CropFieldOnY" данные методы обрезают до нужных размеров имеющееся поле с права и снизу с сохранением состояния оставшейся области.
+ "EnlargeFieldOnX" и "EnlargeFieldOnY" данные методы дополняют до указанных размеров имеющееся поле справа и снизу пустыми ("мертвыми") ячейками. На любом шаге игра может быть остановлена и размеры поля могут быть изменены, ячейки могут быть дорисованы или стерты, а игра продолжена далее.
+ Оставшиеся методы обеспечивают доступ к конкретным ячейкам по координатам и запись либо удаление значений в них (на трех последних поколениях), а так же изменение значений на противоположное в текущем поколении. Импортирует ModelSquare. Класс относится к Model паттерна MVC.

Два этих класса используются только как структуры для хранения информации, логики игры в них нет.

3. Класс ModelChangeField. Класс изменения поля. Содержит два метода, оба для работы на вход принимают экземпляр класса ModelField. Первый метод "FieldManipulatorByAlgorithm" обеспечивает обработку значений ячеек имеющегося поля и изменение их состояний в соответствии с логикой игры. Так же записывает данные прошлых и позапрошлых поколений в соответствующие свойства ячеек поля. Второй метод "StopGame" просматривает поле на текущем, прошлом и позапрошлом поколениях и если складываются условия для остановки игры, генерирует сигнал остановки и записывает одно из 3 состояний во флаг остановки игры поля. Класс относится к Model паттерна MVC.

Данный класс содержит основную логику игры.

4. Класс View. Класс отвечает за отрисовку поля, отображение номера текущего поколения и вывод информационного окошка об остановке игры с указанием причины остановки. Содержит единственный метод "UpdateView", который на вход принимает экземпляр класса ModelField. Из него берет данные о состоянии ячеек, создает таблицу поля в html документе с соответствующим классами CSS нужных ячеек, обеспечивающими цветовое оформление состояний "жив"-"мертв". Кроме этого присваивает ячейкам таблицы id в котором указаны координаты в ячейке. Это необходимо для возможности рисовать поле кликом мышки по ячейкам. Так же из поля берется информации об остановке игры и выводится причина в сообщении. Класс относится к View паттерна MVC.

5. Класс Controller. Содержит в себе все обработчики событий возникающих при взаимодействии пользователя с контролами. Связывает воедино предыдущие 4 класса. Содержит следующие обработчики событий:
+ Обработчик клика по кнопке "СОЗДАТЬ" - устанавливает размеры поля в соответствии с тем, что введено в поля ширины и высоты, вызывает метод рандомного создания поля "CreateRandomField", вызывает метод отрисовки поля "UpdateView".
+ Обработчик клика по кнопке "СТЕРЕТЬ" - устанавливает размеры поля в соответствии с тем, что введено в поля ширины и высоты, вызывает метод стирания поля "ClearField", вызывает метод отрисовки поля "UpdateView".
+ Обработчик клика по кнопке "СТАРТ" - останавливает таймер (на случай если кнопка "СТАРТ" уже была нажата до этого), создает новый таймер, который с периодичностю в соответствии с установленным значением контрола "Скорость" выполняет один и тот же код - вызов метода "StopGame" для генерации сигнала остановки игры и записи его в свойство поля "GameOver", вызов метода "FieldManipulatorByAlgorithm", который преобразует поле в соответствии с логикой игры, вызов метода отрисовки поля "UpdateView" (если "GameOver" имеет соответствующее значение, то выводится сообщение об остановке игры). Так же просматривается свойство поля "GameOver" - если имеется сигнал об остановке игры - таймер останавливается.
+ Обработчик клика по кнопке "СТОП" - останавливает таймер.
+ Обработчик клика по кнопке "1 ШАГ" - делает то же что и обработчик клика по кнопке "СТАРТ", но без таймера 1 раз, проверка поля на наличие сигнала к остановке не происходит.
+ Обработчик клика по ячейке - получает координаты ячейки по ее id, и вызывает метод изменения состояния ячейки на противоположное по этим координатам.
+ Обработчики анфокуса полей ввода ширины и высоты поля - при исчезновении фокуса у данных полей и если значения этих полей были изменены - вызывается один из соответствующих методов "CropFieldOnX", "CropFieldOnY", "EnlargeFieldOnX" и "EnlargeFieldOnY" класса ModelField, что вызывает изменение размеров поля.
+ Обработчик отпускания контрола скорости - необходим для динамического изменения скорости игры во время ее выполнения. Фактически вызывает набор тех же действий что и кнопка "СТАРТ".
Класс относится к Controller паттерна MVC.

В Application.js данные классы импортируются, создается экземпляр каждого класса. Экземпляры классов ModelField (в его модуль уже импортирован класс ModelSquare), ModelChangeField, View передаются экземпляру класса Controller. Application.js подключен к html-странице, на которой созданы контролы с соответствующими id, и создан блок для отрисовки в нем таблицы для отображения поля. Таким образом обеспечивается разделение приложения на четкие слои. Сама информация и логика ее преобразования содержится в классах Model, вызывает эти преобразования класс Controller, он же передает вызовом соответствующего метода классу View команду на отображение. View берет необходимую информацию из класса модели (таким образом View так же "знает" о модели). Controller "знает" и о Model и о View, вызывая их методы.